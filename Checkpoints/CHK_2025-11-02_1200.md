# CHK_2025-11-02_1200 — Integra RH v2

Referencia PROYECTO.md: PVM-WEB-03 [>] (Listado de Clientes), PVM-INT-API-01/02 [✓], trabajos en Psicométricas y Procesos.

## Qué se hizo
- Directivas unificadas agregadas: `context/Directivas_Unificadas.md`.
- Paridad funciones Firebase → tRPC: `context/varios/LEGACY_FUNCTIONS_PARITY.md` (mapa y pendientes).
- Psicométricas:
  - Integración: añadida `listarBaterias()` en `server/integrations/psicometricas.ts` (con cache en memoria).
  - API tRPC: `psicometricas.getBaterias` en `server/routers/psicometricas.ts`.
  - Web (parcial): `CandidatoDetalle.tsx` ahora muestra un selector de baterías cuando hay catálogo disponible (fallback a input manual).
- Procesos:
  - API tRPC: `processes.updateStatus` para cambiar `estatusProceso`.

## Cómo se probó (sugerido)
- Backend: reiniciar servidor `pnpm dev:server` y verificar que `GET /api/trpc/psicometricas.getBaterias` responde (vía client o DevTools de tRPC).
- Frontend: en CandidatoDetalle abrir sección “Psicométricas”; confirmar que aparece el selector si la API de baterías está disponible.
- Procesos: invocar `processes.updateStatus` desde consola tRPC/React Query DevTools y validar cambio en DB.

## Cambios de configuración/esquema
- Sin cambios de esquema. Requiere que existan `PSICOMETRICAS_TOKEN` y `PSICOMETRICAS_PASSWORD` en `.env` para listar baterías.

## Pendientes inmediatos
- UI de cambio de estatus en `ProcesoDetalle` (usar `processes.updateStatus`).
- Completar manejo de webhook en `integrations/psicometricas.handleWebhookPsicometricas` (actualizar estatus y guardar JSON/PDF).
- Opcional: auto-mapear selección de batería → checkboxes de tests.

## Nota .env
- `.env` local ya contiene VITE_FIREBASE_* y DB. Confirmar `PSICOMETRICAS_TOKEN`, `PSICOMETRICAS_PASSWORD` y `SENDGRID_API_KEY`.

